I know this is not done very Scala-ish way.
Mutations and side effects are nasty.
It's 1am, don't care.